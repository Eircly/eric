$$
X=\left[X_{1}, \quad X_{2}, \quad X_{3}, \quad \cdots, \cdots, X_{n}\right]^{T} \text {, }
$$

$$
Y=\left[Y_{1}, \quad Y_{2}, \quad Y_{3}, \quad \cdots, \cdots, Y_{n}\right]^{T} \text {, }
$$

模式层
$$
P_{i}=\exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \quad i=1,2, \cdots,n
$$
求和层

1算数求和
$$
\sum\limits_{i=1}^{n} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \quad i=1,2, \cdots, n
$$
模式层与各个神经元的连接权值为 1，传递函数为
$$
S_{D}=\sum\limits_{i=1}^{n} p_{i} \quad \mathrm{i}=1,2, \cdots, \mathrm{n}
$$
2加权求和
$$
\sum\limits_{i=1}^{n} Y_{i} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \quad i=1,2, \cdots,n
$$
神经元之间的连接权值为第 $$i$$ 个输出样本 $Y_{i}$ 中 的第 $j$ 个元素，传递函数为：
$$
S_{N j}=\sum\limits_{i=1}^{n} y_{i j} p_{i} \quad \mathrm{j}=1,2, \cdots, \mathrm{k}
$$


输出层：神经元数目等于学习样本中输出向量的位数 $k$，各神经元将求和层的输出相除，神经元$j$ 的输出对应估计结果 $\overleftarrow{\boldsymbol{Y}}(X)$ 的第$ j$ 个元素：
$$
y_{j}=\frac{S_{N j}}{S_{D}} \quad j=1,2, \cdots, \mathrm{k}
$$
1.2 GRNN 的理论基础 

1.2.1　基于非线性回归分析 非独立变量$ Y $相对于独立变量$ x$（其观测值为$ X$）的回归分析，实质上就是计算最大概率值 $y$。假 设随机变量 $X$ 与$ y$ 的联合概率密度函数$ f(x,y)$，则 y $相对于 X 的回归为 
$$
\overleftarrow{\boldsymbol{Y}}=\frac{\int_{-\infty}^{+\infty} y f(X, y) d y}{\int_{-\infty}^{+\infty} f(X, y) d y}  \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \  (7)
$$
其中：Y 即为输入 X 时的预测输出

1.2.2 密度函数的估算 

由样本数据集  $\left\{x_{i}, y_{i}\right\}_{i=1}^{n}$ , 估算密度函数  $\overleftarrow{f}(X, y) $ 。

$\bar{f}(X, y)=\frac{1}{n(2 \pi)^{\frac{p+1}{2}} \sigma^{p+1}} \sum_{i=1}^{n} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \exp \left[-\frac{\left(X-Y_{i}\right)^{2}}{2 \sigma^{2}}\right]$

其中：Xi 、Yi 为随机变量 x、y 的样本观测值，n 为样本容量，p 为随机变量 x 的维数，σ（光滑因子） 为高斯函数的宽度系数。

用  $\overleftarrow{f}(X, y)$  替代  $f(X, y)$  代入公式 (7), 得:

$\overleftarrow{Y}(X)=\frac{\sum\limits_{i=1}^{n} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \int_{-\infty}^{\infty} y \exp \left[-\frac{\left(Y-Y_{i}\right)^{2}}{2 \sigma^{2}}\right] d y}{\sum\limits_{i=1}^{n} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right] \int_{-\infty}^{\infty} \exp \left[-\frac{\left(Y-Y_{i}\right)^{2}}{2 \sigma^{2}}\right] d y}$

由于  $\int_{-\infty}^{+\infty} z e^{-z^{2}} d z=0$ , 则计算后得到网络输出  $\overleftarrow{Y}(X)$  为:

$\overleftarrow{Y}(X)=\frac{\sum\limits_{i=1}^{n} Y_{i} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right]}{\sum\limits_{i=1}^{n} \exp \left[-\frac{\left(X-X_{i}\right)^{T}\left(X-X_{i}\right)}{2 \sigma^{2}}\right]}$

其中: 估计值  $\overleftarrow{Y}(X) $ 为所有样本观测值  $Y_{i}$  的加 权平均, 每个观测值  $Y_{i}$  的权重因子为样本  $X_{i}$  与 $ X  $之间的 Euclid 距离平方的指数

1.2.3　光滑因子$σ $的影响 光滑因子σ 较大，则概率密度函数的估计比较 平滑，为多 Gauss 函数，当σ →∞时， (X) 为所有样 本因变量的均值；光滑因子σ 较小时，概率密度函数 的估计为非 Gauss 函数，σ → 0 时， (X) 为与输入 变量 X 之间 Euclid 距离最近的样本观测值import pandas

from spsspro.algorithm import descriptive_analysis
#生成案例数据
data = pandas.DataFrame({
    "A": [1, 2, 3],
    "B": [2, 3, 4]
})
#相关性分析，输入参数详细可以光标放置函数括号内按shift+tab查看，输出结果参考spsspro模板分析报告
result = descriptive_analysis.correlation_analysis(data)
print(result)
    